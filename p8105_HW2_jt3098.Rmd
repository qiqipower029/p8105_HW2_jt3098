---
title: "p8105_HW2_jt3098"
author: "Jieqi Tu (jt3098)"
date: "9/29/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(haven)
library(readxl)
```

## Problem 1
```{r importing data}
subway_data = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada)

subway_data$entry = ifelse(subway_data$entry == "YES", TRUE, FALSE)

```

This dataset is called subway_data. The variable it contains are below:

* line: the avenue or road in NYC that the station located in
* station_name: the names of all stations
* station_latitude: the latitude value for this station
* station_longitude: the longitude value for this station
* route1:route11: the train that stops at this station
* entry: whether or not there is entry for this station
* vending: whether or not there is vending for this station
* entrance_type: the type of the entrance
* ada:  whether or not there is ada compliance in this station

Cleaning steps:

* Import csv file from the data folder
* Use janitor::clean_names() function to convert all upper-case letters to lower-case.
* Use select function to carefully choose columns required to show up in the dataset
* Use ifelse() function to convert entry variable from character to logical.

* Dimension: rows: `r nrow(subway_data)`; columns: `r ncol(subway_data)`.
* This dataset is not tidy, because columns in this dataset are not only variables. Also, some of the columns need to be combinded or collapsed.

```{r questions}
distinction = distinct(subway_data, station_name, line)
subway_data %>%  
  filter(ada == TRUE) %>%
  distinct(line, station_name) %>%
  nrow()
n_entrance_novending = filter(subway_data, entry == "TRUE", vending == "NO") %>%
  distinct(line, station_name) %>%
  nrow()
n_exit_nonvending = filter(subway_data, entry == "FALSE", vending == "NO") %>%
  distinct(line, station_name) %>%
  nrow()
```

* There are `r nrow(distinction)` distinct stations in NYC.
* There are 84 stations are ADA compliant.
* The proportion of non-vending entrance is `r n_entrance_novending / nrow(distinction)`; the proportion of non-vending exit is `r n_exit_nonvending / nrow(distinction)`

```{r reformatting}
subway_data_tidy = gather(subway_data, key = "route_number", value = "route_name", route1:route11)
```

```{r questions2}
A_stations = filter(subway_data_tidy, route_name == "A") %>%
  distinct(line, station_name) %>%
  nrow()
A_compliant = filter(subway_data_tidy, route_name == "A", ada == TRUE) %>%
  distinct(line, station_name) %>%
  nrow()
```

* In NYC, `r A_stations` distinct stations serve A train, `r A_compliant` of which are ADA compliant.

## Problem 2

```{r importing data}
waterwheel_data = read_excel(path = "./data/HealthyHarborWaterWheelTotals.xlsx", range = "A2:N256") %>%
  janitor::clean_names() %>%
  filter(!is.na(dumpster))


```

